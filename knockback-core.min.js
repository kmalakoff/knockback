/*
  knockback-core.js 1.2.3
  Copyright (c)  2011-2022 Kevin Malakoff.
  License: MIT (http://www.opensource.org/licenses/mit-license.php)
  Source: https://github.com/kmalakoff/knockback
  Dependencies: Knockout.js, Backbone.js, and Underscore.js (or LoDash.js).
  Optional dependencies: Backbone.ModelRef.js and BackboneORM.
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("backbone"),require("underscore"),require("knockout")):"function"==typeof define&&define.amd?define(["backbone","underscore","knockout"],t):"object"==typeof exports?exports.kb=t(require("backbone"),require("underscore"),require("knockout")):e.kb=t(e.Backbone,e._,e.ko)}(this,function(r,n,i){return a=[function(r,e,i){"use strict";!function(e){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var t,l,u=null!=u?u:e,c=i(23),d=["release","destroy","dispose"];r.exports=e=function(){var e,t=function(){function s(){if(!(this instanceof s))throw new TypeError("Cannot call a class as a function")}var e,t,r;return e=s,r=[{key:"wasReleased",value:function(e){return!e||e.__kb_released}},{key:"isReleaseable",value:function(e){var t,r,n,i,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(e&&e===Object(e)&&!e.__kb_released){if(c.isObservable(e)||e instanceof s.ViewModel)return!0;if("function"!=typeof e&&!s.isModel(e)&&!s.isCollection(e)){for(t=0,n=d.length;t<n;t++)if("function"==typeof e[d[t]])return!0;if(!(0<o))for(r in e)if(i=e[r],"__kb"!==r&&s.isReleaseable(i,o+1))return!0}}return!1}},{key:"release",value:function(e){var t,r,n,i,o,a;if(s.isReleaseable(e))if(e.__kb_released=!0,l.isArray(e))for(r in e)a=e[r],s.isReleaseable(a)&&(e[r]=null,s.release(a));else{if(!c.isObservable(e)||!l.isArray(t=s.peek(e))){for(n=0,i=d.length;n<i;n++)if("function"==typeof e[o=d[n]])return e[o].call(e);return c.isObservable(e)?void 0:this.releaseKeys(e)}if(e.__kb_is_co||e.__kb_is_o&&e.valueType()===s.TYPE_COLLECTION)return"function"==typeof e.destroy?e.destroy():void 0;for(r in t)a=t[r],s.isReleaseable(a)&&(t[r]=null,s.release(a));"function"==typeof e.dispose&&e.dispose()}}},{key:"releaseKeys",value:function(e){var t,r;for(t in e)r=e[t],"__kb"!==t&&s.isReleaseable(r)&&(e[t]=null,s.release(r))}},{key:"releaseOnNodeRemove",value:function(e,t){return e||s._throwUnexpected(this,"missing view model"),t||s._throwUnexpected(this,"missing node"),c.utils.domNodeDisposal.addDisposeCallback(t,function(){return s.release(e)})}},{key:"renderTemplate",value:function(e,t){var r,n,i,o,a,l=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(!(o=null!=u?u.document:void 0))return"undefined"!=typeof console&&null!==console?console.log("renderTemplate: document is undefined"):void 0;if(r=o.createElement("div"),o=c.renderTemplate(e,t,l,r,"replaceChildren"),1===r.childNodes.length)r=r.childNodes[0];else if(r.childNodes.length)for(n=i=0,a=r.childNodes.length;0<=a?i<=a:a<=i;n=0<=a?++i:--i)try{c.storedBindingContextForNode(r,c.contextFor(r.childNodes[n]));break}catch(e){}return s.releaseOnNodeRemove(t,r),o.dispose(),t.afterRender&&!l.afterRender&&t.afterRender(r),r}},{key:"applyBindings",value:function(e,t){var r,n,i,o;if(t.length){var a=[document.createElement("div"),t];for(t=a[0],i=0,o=(n=a[1]).length;i<o;i++)r=n[i],t.appendChild(r)}return c.applyBindings(e,t),s.releaseOnNodeRemove(e,t),t}},{key:"getValue",value:function(e,t,r){var n;if(e)return l.isFunction(e[t])&&null!=(n=s.settings.orm)&&n.useFunction(e,t)?e[t]():r?e.get.apply(e,l.map([t].concat(r),function(e){return s.peek(e)})):e.get(t)}},{key:"setValue",value:function(e,t,r){var n;if(e)return l.isFunction(e[t])&&null!=(n=s.settings.orm)&&n.useFunction(e,t)?e[t](r):((n={})[t]=r,e.set(n))}},{key:"_throwMissing",value:function(e,t){throw"".concat(l.isString(e)?e:e.constructor.name,": ").concat(t," is missing")}},{key:"_throwUnexpected",value:function(e,t){throw"".concat(l.isString(e)?e:e.constructor.name,": ").concat(t," is unexpected")}},{key:"publishMethods",value:function(e,t,r){for(var n,i=0,o=r.length;i<o;i++)e[n=r[i]]=s._.bind(t[n],t)}},{key:"peek",value:function(e){return c.isObservable(e)?e.peek?e.peek():s.ignore(function(){return e()}):e}},{key:"isModel",value:function(e){return e&&(e instanceof s.Model||"function"==typeof e.get&&"function"==typeof e.bind)}},{key:"isCollection",value:function(e){return e&&e instanceof s.Collection}}],(t=null)&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),s}();return t.VERSION="1.2.3",t.TYPE_UNKNOWN=0,t.TYPE_SIMPLE=1,t.TYPE_ARRAY=2,t.TYPE_MODEL=3,t.TYPE_COLLECTION=4,t.ignore=(null!=(e=c.dependencyDetection)?e.ignore:void 0)||function(e,t,r){var n=null;return c.computed(function(){return n=e.apply(t,r||[])}).dispose(),n},t.extend=i(16),t}.call(void 0),l=u.Parse?(t=e.Parse=u.Parse,e._=u.Parse._):(t=e.Backbone=i(21),e._=i(22)),e.ko=c,e.Collection=t.Collection,e.Model=t.Object||t.Model,e.Events=t.Events}.call(e,i(3))},function(e,t,r){"use strict";var n,i,o,a=n=r(0),l=a._,s=(a.ko,{default:null,"backbone-orm":null,"backbone-associations":r(19),"backbone-relational":r(20)});for(i in n.settings={orm:s.default},s){if((o=s[i])&&o.isAvailable())break;n.settings.orm=o}e.exports=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};for(i in t)if(o=t[i],"orm"===i)l.isString(o)?s.hasOwnProperty(o)?(e=s[o])&&!e.isAvailable()?console.log("Knockback configure: could not enable orm ".concat(o,". Make sure it is included before Knockback")):n.settings.orm=e:console.log("Knockback configure: could not find orm: ".concat(o,". Available: ").concat(l.keys(s).join(", "))):n.settings.orm=o;else n.settings[i]=o}},function(e,t,r){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s,r=s=r(0),u=r._,c=r.ko;e.exports=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.create_options=e,this._vo=c.observable(null)}var e,r,n;return e=t,(r=[{key:"destroy",value:function(){var e;return this.__kb_released=!0,(e=this.__kb_value)&&(this.__kb_value=null,(this.create_options.store&&s.utils.wrappedCreator(e)?this.create_options.store:s).release(e)),this.create_options=null}},{key:"value",value:function(){return c.utils.unwrapObservable(this._vo())}},{key:"rawValue",value:function(){return this.__kb_value}},{key:"valueType",value:function(e,t){e=s.getValue(e,t);return this.value_type||this._updateValueObservable(e),this.value_type}},{key:"update",value:function(e){var t,r,n;if(!this.__kb_released){switch(t=s.utils.valueType(e=void 0===e?null:e),null!=(r=this.__kb_value)&&r.__kb_released&&(this.__kb_value=this.value_type=void 0),n=this.__kb_value,this.value_type){case s.TYPE_COLLECTION:if(this.value_type===s.TYPE_COLLECTION&&t===s.TYPE_ARRAY)return n(e);if(t===s.TYPE_COLLECTION||u.isNull(e))return void(e&&e instanceof s.CollectionObservable?this._updateValueObservable(s.utils.wrappedObject(e),e):s.peek(n.collection)!==e&&n.collection(e));break;case s.TYPE_MODEL:if(t===s.TYPE_MODEL||u.isNull(e))return void(e&&!s.isModel(e)?this._updateValueObservable(s.utils.wrappedObject(e),e):s.utils.wrappedObject(n)!==s.utils.resolveModel(e)&&this._updateValueObservable(e))}if(this.value_type!==t||u.isUndefined(this.value_type)){if(s.peek(n)!==e)return this._updateValueObservable(e)}else if(s.peek(n)!==e)return n(e)}}},{key:"_updateValueObservable",value:function(e,t){var r,n=this.create_options,i=s.utils.inferCreator(e,n.factory,n.path),o=(null!==e||i||(this.value_type===s.TYPE_MODEL?i=s.ViewModel:this.value_type===s.TYPE_COLLECTION&&(i=s.CollectionObservable)),n.creator=i,s.TYPE_UNKNOWN),a=[this.__kb_value,void 0],l=a[0];return this.__kb_value=a[1],t?(r=t,n.store&&n.store.retain(t,e,i)):i?n.store?r=n.store.retainOrCreate(e,n,!0):i.models_only?(r=e,o=s.TYPE_SIMPLE):r=i.create?i.create(e,n):new i(e,n):r=u.isArray(e)?(o=s.TYPE_ARRAY,c.observableArray(e)):(o=s.TYPE_SIMPLE,c.observable(e)),(this.value_type=o)===s.TYPE_UNKNOWN&&(c.isObservable(r)?r.__kb_is_co?(this.value_type=s.TYPE_COLLECTION,s.utils.wrappedObject(r,e)):this.value_type||(this.value_type=s.TYPE_SIMPLE):(this.value_type=s.TYPE_MODEL,s.utils.wrappedObject(r,s.utils.resolveModel(e)))),l&&(this.create_options.store||s).release(l),this.__kb_value=r,this._vo(r)}},{key:"_inferType",value:function(e){}}])&&i(e.prototype,r),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()},function(e,t){var r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var f,a=[].indexOf,r=f=r(0),_=r._,c=r.ko,l=["destroy","shareOptions","filters","comparator","sortAttribute","viewModelByModel","hasViewModels"];f.compare=function(e,t){return _.isString(e)?e.localeCompare("".concat(t)):_.isString(t)?t.localeCompare("".concat(e)):e===t?0:e<t?-1:1},f.CollectionObservable=function(){var e=function(){function n(i,e,o){var a,u=this,t=this,r=n;if(t instanceof r)return this._onCollectionChange=this._onCollectionChange.bind(this),a=Array.prototype.slice.call(_.isArguments(i)?i:arguments),f.ignore(function(){var e,t,r,n,s;for(i=a[0]instanceof f.Collection?a.shift():_.isArray(a[0])?new f.Collection(a.shift()):new f.Collection,_.isFunction(a[0])&&(a[0]={view_model:a[0]}),o={},r=0,n=a.length;r<n;r++)e=a[r],_.extend(o,e);return(s=f.utils.wrappedObservable(u,c.observableArray([]))).__kb_is_co=!0,u.in_edit=0,u.__kb||(u.__kb={}),(o=f.utils.collapseOptions(o)).auto_compact&&(u.auto_compact=!0),o.sort_attribute?u._comparator=c.observable(u._attributeComparator(o.sort_attribute)):u._comparator=c.observable(o.comparator),o.filters?u._filters=c.observableArray(_.isArray(o.filters)?o.filters:o.filters?[o.filters]:void 0):u._filters=c.observableArray([]),t=u.create_options={store:f.Store.useOptionsOrCreate(o,i,s)},f.utils.wrappedObject(s,i),u.path=o.path,t.factory=f.utils.wrappedFactory(s,u._shareOrCreateFactory(o)),t.path=f.utils.pathJoin(o.path,"models"),t.creator=t.factory.creatorForPath(null,t.path),t.creator&&(u.models_only=t.creator.models_only),f.publishMethods(s,u,l),u._collection=c.observable(i),s.collection=u.collection=c.computed({read:function(){return u._collection()},write:function(t){return f.ignore(function(){var e;if((e=u._collection())!==t)return f.utils.wrappedObject(s,t),e&&e.unbind("all",u._onCollectionChange),t&&t.bind("all",u._onCollectionChange),u._collection(t)})}}),i&&i.bind("all",u._onCollectionChange),u._mapper=c.computed(function(){var e,t,r,n=u._comparator(),i=u._filters();if(i)for(var o=[],a=0,l=i.length;a<l;a++)e=i[a],o.push(c.utils.unwrapObservable(e));r=u._collection(),u.in_edit||(s=f.utils.wrappedObservable(u),f.peek(s),r=(t=r?r.models:t)&&0!==r.models.length?(t=_.filter(t,function(e){return!i.length||u._selectModel(e)}),n?_.map(t,function(e){return u._createViewModel(e)}).sort(n):u.models_only?i.length?t:t.slice():_.map(t,function(e){return u._createViewModel(e)})):[],u.in_edit++,s(r),u.in_edit--)}),s.subscribe(_.bind(u._onObservableArrayChange,u)),f.statistics&&f.statistics.register("CollectionObservable",u),s});throw new TypeError("Cannot call a class as a function")}var e,t,r;return e=n,(t=[{key:"destroy",value:function(){var e,t;return this.__kb_released=!0,t=f.utils.wrappedObservable(this),e=f.peek(this._collection),f.utils.wrappedObject(t,null),e&&(e.unbind("all",this._onCollectionChange),(e=f.peek(t)).splice(0,e.length)),this.collection.dispose(),this._collection=t.collection=this.collection=null,this._mapper.dispose(),this._mapper=null,f.release(this._filters),this._filters=null,this._comparator(null),this._comparator=null,this.create_options=null,t.collection=null,f.utils.wrappedDestroy(this),!f.statistics||f.statistics.unregister("CollectionObservable",this)}},{key:"shareOptions",value:function(){var e=f.utils.wrappedObservable(this);return{store:f.utils.wrappedStore(e),factory:f.utils.wrappedFactory(e)}}},{key:"filters",value:function(e){return e?this._filters(_.isArray(e)?e:[e]):this._filters([])}},{key:"comparator",value:function(e){return this._comparator(e)}},{key:"sortAttribute",value:function(e){return this._comparator(e?this._attributeComparator(e):null)}},{key:"viewModelByModel",value:function(r){var n;return this.models_only?null:(n=r.hasOwnProperty(r.idAttribute)?r.idAttribute:"cid",_.find(f.peek(f.utils.wrappedObservable(this)),function(e){var t;return!(null==e||null==(t=e.__kb)||!t.object)&&e.__kb.object[n]===r[n]}))}},{key:"hasViewModels",value:function(){return!this.models_only}},{key:"compact",value:function(){var t=this;return f.ignore(function(){var e=f.utils.wrappedObservable(t);if(f.utils.wrappedStoreIsOwned(e))return f.utils.wrappedStore(e).clear(),t._collection.notifySubscribers(t._collection())})}},{key:"_shareOrCreateFactory",value:function(e){var t,r,n=f.utils.pathJoin(e.path,"models"),i=e.factories;if((r=e.factory)&&(t=r.creatorForPath(null,n))&&(!i||i.models===t)){if(!i)return r;if(r.hasPathMappings(i,e.path))return r}return r=new f.Factory(e.factory),i&&r.addPathMappings(i,e.path),r.creatorForPath(null,n)||(e.hasOwnProperty("models_only")?e.models_only?r.addPathMapping(n,{models_only:!0}):r.addPathMapping(n,f.ViewModel):e.view_model?r.addPathMapping(n,e.view_model):e.create?r.addPathMapping(n,{create:e.create}):r.addPathMapping(n,f.ViewModel)),r}},{key:"_onCollectionChange",value:function(n,i){var o=this;return f.ignore(function(){var e,t,r;if(!o.in_edit&&!f.wasReleased(o))switch(n){case"reset":o.auto_compact?o.compact():o._collection.notifySubscribers(o._collection());break;case"sort":case"resort":o._collection.notifySubscribers(o._collection());break;case"new":case"add":if(!o._selectModel(i))return;if(r=f.utils.wrappedObservable(o),-1===(e=o._collection()).indexOf(i))return;if(o.viewModelByModel(i))return;o.in_edit++,(t=o._comparator())?(r().push(o._createViewModel(i)),r.sort(t)):r.splice(e.indexOf(i),0,o._createViewModel(i)),o.in_edit--;break;case"remove":case"destroy":o._onModelRemove(i);break;case"change":if(!o._selectModel(i))return o._onModelRemove(i);if(!(o.models_only?i:o.viewModelByModel(i)))return o._onCollectionChange("add",i);if(!(t=o._comparator()))return;o.in_edit++,f.utils.wrappedObservable(o).sort(t),o.in_edit--}})}},{key:"_onModelRemove",value:function(e){var t,e=this.models_only?e:this.viewModelByModel(e);if(e)return t=f.utils.wrappedObservable(this),this.in_edit++,t.remove(e),this.in_edit--}},{key:"_onObservableArrayChange",value:function(c){var d=this;return f.ignore(function(){var e,t,r,n,i,o,a,l,s,u;if(!d.in_edit&&(d.models_only&&(!c.length||f.isModel(c[0]))||!d.models_only&&(!c.length||_.isObject(c[0])&&!f.isModel(c[0]))||f._throwUnexpected(d,"incorrect type passed"),l=f.utils.wrappedObservable(d),e=f.peek(d._collection),r=f.peek(d._filters).length,e)){if(u=c,d.models_only)a=_.filter(c,function(e){return!r||d._selectModel(e)});else for(r&&(u=[]),a=[],n=0,i=c.length;n<i;n++){if(s=c[n],o=f.utils.wrappedObject(s),r){if(!d._selectModel(o))continue;u.push(s)}(t=d.create_options.store.find(o,d.create_options.creator))&&t.constructor!==s.constructor&&f._throwUnexpected(d,"replacing different type of view model"),d.create_options.store.retain(s,o,d.create_options.creator),a.push(o)}d.in_edit++,c.length!==u.length&&l(u),_.isEqual(e.models,a)||e.reset(a),d.in_edit--}})}},{key:"_attributeComparator",value:function(n){var r=function(e,t){var r=c.utils.unwrapObservable(n);return f.compare(e.get(r),t.get(r))};return this.models_only?r:function(e,t){return r(f.utils.wrappedModel(e),f.utils.wrappedModel(t))}}},{key:"_createViewModel",value:function(e){return this.models_only?e:this.create_options.store.retainOrCreate(e,this.create_options)}},{key:"_selectModel",value:function(e){for(var t,r,n=f.peek(this._filters),i=0,o=n.length;i<o;i++)if(t=n[i],t=f.peek(t),_.isFunction(t)){if(!t(e))return!1}else if(_.isArray(t)){if(r=e.id,a.call(t,r)<0)return!1}else if(e.id!==t)return!1;return!0}}])&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),n}();return e.extend=f.extend,e}.call(void 0),f.collectionObservable=function(e,t,r){return new f.CollectionObservable(arguments)},f.observableCollection=f.collectionObservable},function(e,t,r){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u,r=u=r(0),c=r._,d=r.ko;u.EventWatcher=function(){function n(e,t,r){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");this._onModelLoaded=this._onModelLoaded.bind(this),this._onModelUnloaded=this._onModelUnloaded.bind(this),this._unbindCallbacks=this._unbindCallbacks.bind(this),this.__kb||(this.__kb={}),this.__kb.callbacks={},this.ee=null,r&&this.registerCallbacks(t,r),e&&this.emitter(e)}var e,t,r;return e=n,r=[{key:"useOptionsOrCreate",value:function(e,t,r,n){return e.event_watcher?(e.event_watcher.emitter()!==t&&e.event_watcher.model_ref!==t&&u._throwUnexpected(this,"emitter not matching"),u.utils.wrappedEventWatcher(r,e.event_watcher).registerCallbacks(r,n)):(u.utils.wrappedEventWatcherIsOwned(r,!0),u.utils.wrappedEventWatcher(r,new u.EventWatcher(t)).registerCallbacks(r,n))}}],(t=[{key:"destroy",value:function(){return this.emitter(null),this.__kb.callbacks=null,u.utils.wrappedDestroy(this)}},{key:"emitter",value:function(e){return 0===arguments.length||this.ee===e?this.ee:(this.model_ref&&(this.model_ref.unbind("loaded",this._onModelLoaded),this.model_ref.unbind("unloaded",this._onModelUnloaded),this.model_ref.release(),this.model_ref=null),u.Backbone&&u.Backbone.ModelRef&&e instanceof u.Backbone.ModelRef?(this.model_ref=e,this.model_ref.retain(),this.model_ref.bind("loaded",this._onModelLoaded),this.model_ref.bind("unloaded",this._onModelUnloaded),e=this.model_ref.model()||null):delete this.model_ref,this.ee!==e&&(e?this._onModelLoaded(e):this._onModelUnloaded(this.ee)),e)}},{key:"registerCallbacks",value:function(e,t){var r,n,i,o,l,s=this;for(e||u._throwMissing(this,"obj"),t||u._throwMissing(this,"callback_info"),n=t.event_selector?t.event_selector.split(" "):["change"],l=this.ee,i=0,o=n.length;i<o;i++)(r=n[i])&&!function(o){var a;(a=(a=s.__kb.callbacks[o])?a:s.__kb.callbacks[o]={model:null,list:[],fn:function(e){for(var t,r=a.list,n=0,i=r.length;n<i;n++)!(t=r[n]).update||e&&t.key&&e.hasChanged&&!e.hasChanged(d.utils.unwrapObservable(t.key))||(u.statistics&&u.statistics.addModelEvent({name:o,model:e,key:t.key,path:t.path}),t.update());return null}}).list.push(c.defaults({obj:e},t)),l&&s._onModelLoaded(l)}(r);return this}},{key:"releaseCallbacks",value:function(e){var t,r,n;for(r in this.ee=null,n=this.__kb.callbacks)t=n[r],this._unbindCallbacks(r,t,u.wasReleased(e));return delete this.__kb.callbacks}},{key:"_onModelLoaded",value:function(e){var t,r,n,i,o,a,l,s;for(r in this.ee=e,a=this.__kb.callbacks)for((t=a[r]).model&&t.model!==e&&this._unbindCallbacks(r,t,!0),t.model||(t.model=e).bind(r,t.fn),n=0,o=(l=t.list).length;n<o;n++)(i=l[n]).unbind_fn||(i.unbind_fn=null!=(s=u.settings.orm)?s.bind(e,i.key,i.update,i.path):void 0),i.emitter&&i.emitter(e)}},{key:"_onModelUnloaded",value:function(e){var t,r,n;if(this.ee===e)for(r in this.ee=null,n=this.__kb.callbacks)t=n[r],this._unbindCallbacks(r,t)}},{key:"_unbindCallbacks",value:function(e,t,r){var n,i,o,a;for(t.model&&(t.model.unbind(e,t.fn),t.model=null),n=0,o=(a=t.list).length;n<o;n++)(i=a[n]).unbind_fn&&(i.unbind_fn(),i.unbind_fn=null),!i.emitter||r||u.wasReleased(i.obj)||i.emitter(null)}}])&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),n}(),u.emitterObservable=function(e,t){return new u.EventWatcher(e,t)}},function(e,t,r){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a;a=r(0),a._;a.Factory=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.paths={},e&&(this.parent_factory=e)}var e,r,n;return e=t,n=[{key:"useOptionsOrCreate",value:function(e,t,r){return e.factory&&(!e.factories||e.factories&&e.factory.hasPathMappings(e.factories,r))?a.utils.wrappedFactory(t,e.factory):(t=a.utils.wrappedFactory(t,new a.Factory(e.factory)),e.factories&&t.addPathMappings(e.factories,r),t)}}],(r=[{key:"hasPath",value:function(e){var t;return this.paths.hasOwnProperty(e)||(null!=(t=this.parent_factory)?t.hasPath(e):void 0)}},{key:"addPathMapping",value:function(e,t){return this.paths[e]=t}},{key:"addPathMappings",value:function(e,t){var r,n;for(n in e)r=e[n],this.paths[a.utils.pathJoin(t,n)]=r}},{key:"hasPathMappings",value:function(e,t){var r,n,i,o=!0;for(i in e)r=e[i],o&=(n=this.creatorForPath(null,a.utils.pathJoin(t,i)))&&r===n;return o}},{key:"creatorForPath",value:function(e,t){var r,n;return(r=this.paths[t])?r.view_model||r:(r=null!=(n=this.parent_factory)?n.creatorForPath(e,t):void 0)?r:null}}])&&i(e.prototype,r),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()},function(e,t,r){"use strict";e.exports=e=r(0),e.configure=r(1),e.modules={underscore:e._,backbone:e.Parse||e.Backbone,knockout:e.ko}},function(e,t,n){"use strict";!function(e){function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r,c,t,d=null!=d?d:e,e=c=n(0),f=e._,o=e.ko;c.RECUSIVE_AUTO_INJECT=!0,o.bindingHandlers.inject={init:function(e,t,r,n){return c.Inject.inject(o.utils.unwrapObservable(t()),n,e,t,r)}},c.Inject=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function")}var t,r,n;return t=e,n=[{key:"inject",value:function(e,i,o,a,l,s){var t;return t=function(e){var t,r,n;if(f.isFunction(e))i=new e(i,o,a,l),c.releaseOnNodeRemove(i,o);else for(t in e.view_model&&(i=new e.view_model(i,o,a,l),c.releaseOnNodeRemove(i,o)),e)n=e[t],"view_model"!==t&&("create"===t?n(i,o,a,l):f.isObject(n)&&!f.isFunction(n)?(r=s||n&&n.create?{}:i,i[t]=c.Inject.inject(n,r,o,a,l,!0)):i[t]=n);return i},s?t(e):c.ignore(function(){return t(e)})}},{key:"injectViewModels",value:function(e){var t,r,n,i,o,a,l,s=[],u=function(e){var t,r,n,i,o;for(e.__kb_injected||e.attributes&&(t=f.find(e.attributes,function(e){return"kb-inject"===e.name}))&&(e.__kb_injected=!0,s.push({el:e,view_model:{},binding:t.value})),n=0,i=(o=e.childNodes).length;n<i;n++)r=o[n],u(r)};for(!e&&null!=d&&d.document&&(e=d.document),u(e),o=0,a=s.length;o<a;o++)(i=(r=s[o]).binding)&&(i.search(/[:]/)<0||(i="{".concat(i,"}")),(i=(i=new Function("","return ( ".concat(i," )"))())||{}).options&&(l=i.options,delete i.options),l=l||{},r.view_model=c.Inject.inject(i,r.view_model,r.el,null,null,!0),t=r.view_model.afterBinding||l.afterBinding,n=r.view_model.beforeBinding||l.beforeBinding),n&&n.call(r.view_model,r.view_model,r.el,l),c.applyBindings(r.view_model,r.el,l),t&&t.call(r.view_model,r.view_model,r.el,l);return s}}],(r=null)&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),r=o.applyBindings,o.applyBindings=function(e,t){if(!(c.RECUSIVE_AUTO_INJECT?c.injectViewModels(t):[]).length)return r.apply(this,arguments)},c.injectViewModels=c.Inject.injectViewModels,"undefined"!=typeof document&&null!==document&&(t=function(){return"complete"!==document.readyState?setTimeout(t,0):c.injectViewModels()})()}.call(t,n(3))},function(e,t,r){"use strict";o=r(0);var i,o,n,r=o.ko;null!=(n=r.subscribable)&&(null!=(n=n.fn)&&n.extend)&&(i=r.subscribable.fn.extend,r.subscribable.fn.extend=function(){var e,t=arguments,r=this,n=i.apply(this,arguments);return n!==this&&o.isReleaseable(this)&&(e=n.dispose,n.dispose=function(){return null!=e&&e.apply(n,t),o.release(r)}),n})},function(e,t,r){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c,n=c=r(0),d=n._,f=n.ko,_=r(2),p=["value","valueType","destroy"],b=["args","read","write"];c.Observable=function(){function n(a,l,s){var u=this,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},t=this,r=n;if(t instanceof r)return this._vm=e,c.ignore(function(){var e,t,r,n,i,o;for(l||c._throwMissing(u,"key_or_info"),u.key=l.key||l,r=0,i=b.length;r<i;r++)n=b[r],l[n]&&(u[n]=l[n]);return t=(e=c.utils.collapseOptions(s)).event_watcher,delete e.event_watcher,u._value=new _(e),u._model=f.observable(),(o=c.utils.wrappedObservable(u,f.computed({read:function(){for(var e,t,r,n=u._model(),i=t=[u.key].concat(u.args||[]),o=0,a=i.length;o<a;o++)e=i[o],f.utils.unwrapObservable(e);return null!=(r=c.utils.wrappedEventWatcher(u))&&r.emitter(n||null),u.read?u.update(u.read.apply(u._vm,t)):d.isUndefined(n)||c.ignore(function(){return u.update(c.getValue(n,c.peek(u.key),u.args))}),u._value.value()},write:function(r){return c.ignore(function(){var e=c.utils.unwrapModels(r),t=c.peek(u._model);return u.write?(u.write.call(u._vm,e),r=c.getValue(t,c.peek(u.key),u.args)):t&&c.setValue(t,c.peek(u.key),e),u.update(r)})},owner:u._vm}))).__kb_is_o=!0,e.store=c.utils.wrappedStore(o,e.store),e.path=c.utils.pathJoin(e.path,u.key),e.factories&&("function"==typeof e.factories||e.factories.create)?(e.factory=c.utils.wrappedFactory(o,new c.Factory(e.factory)),e.factory.addPathMapping(e.path,e.factories)):e.factory=c.Factory.useOptionsOrCreate(e,o,e.path),delete e.factories,c.publishMethods(o,u,p),o.model=u.model=f.computed({read:function(){return f.utils.unwrapObservable(u._model)},write:function(t){return c.ignore(function(){var e;if(!u.__kb_released&&c.peek(u._model)!==t)return e=c.getValue(t,c.peek(u.key),u.args),u._model(t),t?d.isUndefined(e)?void 0:u.update(e):u.update(null)})}}),c.EventWatcher.useOptionsOrCreate({event_watcher:t},a||null,u,{emitter:u.model,update:function(){return c.ignore(function(){return u.update()})},key:u.key,path:e.path}),u._value.rawValue()||u._value.update(),c.LocalizedObservable&&l.localizer&&(o=new l.localizer(o)),o=c.DefaultObservable&&l.hasOwnProperty("default")?c.defaultObservable(o,l.default):o});throw new TypeError("Cannot call a class as a function")}var e,t,r;return e=n,(t=[{key:"destroy",value:function(){var e=c.utils.wrappedObservable(this);return this.__kb_released=!0,this._value.destroy(),this._value=null,this.model.dispose(),this.model=e.model=null,c.utils.wrappedDestroy(this)}},{key:"value",value:function(){return this._value.rawValue()}},{key:"valueType",value:function(){return this._value.valueType(c.peek(this._model),c.peek(this.key))}},{key:"update",value:function(e){if(!this.__kb_released)return arguments.length||(e=c.getValue(c.peek(this._model),c.peek(this.key))),this._value.update(e)}}])&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),n}(),c.observable=function(e,t,r,n){return new c.Observable(e,t,r,n)}},function(e,t,r){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r=r(0);var u=r._;e.exports=r.Statistics=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.model_events_tracker=[],this.registered_tracker={}}var t,r,n;return t=e,n=[{key:"eventsStats",value:function(e,t){for(var r,n,i={count:0},o=e._events||e._callbacks||{},a=t?[t]:u.keys(o),l=0,s=a.length;l<s;l++)if(r=o[t=a[l]]){if(u.isArray(r))i[t]=u.compact(r).length;else for(i[t]=0,n=r.tail;(r=r.next)!==n;)i[t]++;i.count+=i[t]}return i}}],(r=[{key:"clear",value:function(){return this.model_events_tracker=[]}},{key:"addModelEvent",value:function(e){return this.model_events_tracker.push(e)}},{key:"modelEventsStatsString",value:function(){var e,t,r,n="";for(t in n+="Total Count: ".concat(this.model_events_tracker.length),e=u.groupBy(this.model_events_tracker,function(e){return"event name: '".concat(e.name,"', attribute name: '").concat(e.key,"'")}))r=e[t],n+="\n ".concat(t,", count: ").concat(r.length);return n}},{key:"register",value:function(e,t){return this.registeredTracker(e).push(t)}},{key:"unregister",value:function(e,t){var r=this.registeredTracker(e);return(t=u.indexOf(r,t))<0?"undefined"!=typeof console&&null!==console?console.log("kb.Statistics: failed to unregister type: ".concat(e)):void 0:r.splice(t,1)}},{key:"registeredCount",value:function(e){var t,r;if(e)return this.registeredTracker(e).length;for(e in t=0,r=this.registered_tracker[e])t+=r[e].length;return t}},{key:"registeredStatsString",value:function(e){var t,r,n,i="",o=this.registered_tracker;for(t in o)(r=o[t]).length&&(n&&(i+="\n "),i+="".concat(t||"No Name",": ").concat(r.length),n=!0);return i||e}},{key:"registeredTracker",value:function(e){return this.registered_tracker.hasOwnProperty(e)?this.registered_tracker[e]:this.registered_tracker[e]=[]}}])&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},function(e,t,r){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a,r=a=r(0),l=r._,s=r.ko;e.exports=a.Store=function(){var e=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.observable_records={},this.replaced_observables=[],a.Store.instances.push(this)}var t,r,n;return t=e,n=[{key:"useOptionsOrCreate",value:function(e,t,r){var n;return e.store||a.utils.wrappedStoreIsOwned(r,!0),(n=a.utils.wrappedStore(r,e.store||new a.Store)).retain(r,t,e.creator),n}}],(r=[{key:"destroy",value:function(){var e;if(this.__kb_released=!0,this.clear(),0<=(e=l.indexOf(a.Store.instances,this)))return a.Store.instances.splice(e,1)}},{key:"clear",value:function(){var e,t,r,n,i,o,a=[this.observable_records,{}],l=a[0];for(t in this.observable_records=a[1],l)for(e in o=l[t])i=o[e],this.release(i,!0);var a=[this.replaced_observables,[]],s=a[0];for(this.replaced_observables=a[1],r=0,n=s.length;r<n;r++)(i=s[r]).__kb_released||this.release(i,!0)}},{key:"compact",value:function(){var e,t,r,n=this.observable_records;for(t in n)for(e in r=n[t])r[e].__kb_released&&delete r[e]}},{key:"retain",value:function(e,t,r){var n;if(this._canRegister(e)){if(r=r||e.constructor,n=this.find(t,r)){if(n===e)return this._getOrCreateStoreReferences(e).ref_count++,e;this._retire(n)}return this._add(e,t,r),this._getOrCreateStoreReferences(e).ref_count++,e}}},{key:"retainOrCreate",value:function(e,t,r){var n,i,o=this;if(!(n=this._creator(e,t)))return a.utils.createFromDefaultCreator(e,t);if(n.models_only)return e;if(i=this.find(e,n))return r&&a.settings.deep_retain?this.retain(i,e,n):i;if(l.isFunction(n.create||n))return i=a.ignore(function(){return t=l.defaults({store:o,creator:n},t),(i=n.create?n.create(e,t):new n(e,t))||s.observable(null)}),this.retain(i,e,n),i;throw new Error('Invalid factory for "'.concat(t.path,'"'))}},{key:"reuse",value:function(e,t){var r,n,i;if((n=a.utils.wrappedObject(e))!==t){if(!this._canRegister(e))throw new Error("Cannot reuse a simple observable");if(1!==this._refCount(e))throw new Error("Trying to change a shared view model. Ref count: ".concat(this._refCount(e)));r=a.utils.wrappedCreator(e)||e.constructor,l.isUndefined(n)||(i=this.find(n,r)),this.retain(e,t,r),i&&this.release(i)}}},{key:"release",value:function(e,t){var r;if(!this._canRegister(e))return a.release(e);if(r=this._storeReferences(e)){if(!t&&0<--r.ref_count)return;this._clearStoreReferences(e)}return this._remove(e),!e.__kb_released&&(t||this._refCount(e)<=1)?a.release(e):void 0}},{key:"find",value:function(e,t){var r;return(t=this.observable_records[this._creatorId(t)])?null!=(r=t[this._cid(e)])&&r.__kb_released?(delete t[this._cid(e)],null):r:null}},{key:"_refCount",value:function(e){return e.__kb_released?("undefined"!=typeof console&&null!==console&&console.log("Observable already released"),0):(e=a.utils.get(e,"stores_references"))?l.reduce(e,function(e,t){return e+t.ref_count},0):1}},{key:"_canRegister",value:function(e){return e&&!s.isObservable(e)&&!e.__kb_is_co}},{key:"_cid",value:function(e){return e?e.cid||(e.cid=l.uniqueId("c")):"null"}},{key:"_creatorId",value:function(e){var t,r,n,i,o=e.create||e;for(o.__kb_cids||(o.__kb_cids=[]),t=0,n=(i=o.__kb_cids).length;t<n;t++)if((r=i[t]).create===o)return r.cid;return o.__kb_cids.push(r={create:o,cid:l.uniqueId("kb")}),r.cid}},{key:"_storeReferences",value:function(e){var t=this;if(e=a.utils.get(e,"stores_references"))return l.find(e,function(e){return e.store===t})}},{key:"_getOrCreateStoreReferences",value:function(e){var t,r=this,n=a.utils.orSet(e,"stores_references",[]);return(t=l.find(n,function(e){return e.store===r}))||n.push(t={store:this,ref_count:0,release:function(){return r.release(e)}}),t}},{key:"_clearStoreReferences",value:function(e){var t,r;if(a.utils.get(e,"stores_references"))for(t in r=e.__kb.stores_references)if(r[t].store===this){e.__kb.stores_references.splice(t,1);break}}},{key:"_retire",value:function(e){return this._clearStoreReferences(e),this.replaced_observables.push(e),this._remove(e)}},{key:"_add",value:function(e,t,r){var n;return r=r||e.constructor,a.utils.wrappedObject(e,t),a.utils.wrappedCreator(e,r),((n=this.observable_records)[r=this._creatorId(r)]||(n[r]={}))[this._cid(t)]=e}},{key:"_remove",value:function(e){var t,r,n=a.utils.wrappedCreator(e)||e.constructor;return(t=this.find(r=a.utils.wrappedObject(e),n))&&t===e&&delete this.observable_records[this._creatorId(n)][this._cid(r)],a.utils.wrappedObject(e,null),a.utils.wrappedCreator(e,null)}},{key:"_creator",value:function(e,t){return t.creator||((t=a.utils.inferCreator(e,t.factory,t.path))?t:a.isModel(e)?a.ViewModel:void 0)}}])&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();return e.instances=[],e}.call(void 0)},function(e,t,r){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o,n=o=r(0),a=n._,l=n.ko;o.utils=function(){var e=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function")}var t,r,n;return t=e,n=[{key:"get",value:function(e,t,r){return e.__kb&&e.__kb.hasOwnProperty(t)?e.__kb[t]:r}},{key:"set",value:function(e,t,r){return(e.__kb||(e.__kb={}))[t]=r}},{key:"orSet",value:function(e,t,r){return(e.__kb||(e.__kb={})).hasOwnProperty(t)||(e.__kb[t]=r),e.__kb[t]}},{key:"has",value:function(e,t){return e.__kb&&e.__kb.hasOwnProperty(t)}},{key:"wrappedObservable",value:function(e,t){return 1===arguments.length?o.utils.get(e,"observable"):o.utils.set(e,"observable",t)}},{key:"wrappedObject",value:function(e,t){return 1===arguments.length?o.utils.get(e,"object"):o.utils.set(e,"object",t)}},{key:"wrappedCreator",value:function(e,t){return 1===arguments.length?o.utils.get(e,"creator"):o.utils.set(e,"creator",t)}},{key:"wrappedModel",value:function(e,t){return 1===arguments.length?a.isUndefined(t=o.utils.get(e,"object"))?e:t:o.utils.set(e,"object",t)}},{key:"wrappedStore",value:function(e,t){return 1===arguments.length?o.utils.get(e,"store"):o.utils.set(e,"store",t)}},{key:"wrappedStoreIsOwned",value:function(e,t){return 1===arguments.length?o.utils.get(e,"store_is_owned"):o.utils.set(e,"store_is_owned",t)}},{key:"wrappedFactory",value:function(e,t){return 1===arguments.length?o.utils.get(e,"factory"):o.utils.set(e,"factory",t)}},{key:"wrappedEventWatcher",value:function(e,t){return 1===arguments.length?o.utils.get(e,"event_watcher"):o.utils.set(e,"event_watcher",t)}},{key:"wrappedEventWatcherIsOwned",value:function(e,t){return 1===arguments.length?o.utils.get(e,"event_watcher_is_owned"):o.utils.set(e,"event_watcher_is_owned",t)}},{key:"valueType",value:function(e){return e?e.__kb_is_o?e.valueType():e.__kb_is_co||e instanceof o.Collection?o.TYPE_COLLECTION:e instanceof o.ViewModel||e instanceof o.Model?o.TYPE_MODEL:a.isArray(e)?o.TYPE_ARRAY:o.TYPE_SIMPLE:o.TYPE_UNKNOWN}},{key:"pathJoin",value:function(e,t){return(e?"."!==e[e.length-1]?"".concat(e,"."):e:"")+t}},{key:"optionsPathJoin",value:function(e,t){return a.defaults({path:this.pathJoin(e.path,t)},e)}},{key:"inferCreator",value:function(e,t,r){return t&&(t=t.creatorForPath(e,r))?t:e?e instanceof o.Model?o.ViewModel:e instanceof o.Collection?o.CollectionObservable:null:null}},{key:"createFromDefaultCreator",value:function(e,t){return o.isModel(e)?o.viewModel(e,t):o.isCollection(e)?o.collectionObservable(e,t):a.isArray(e)?l.observableArray(e):l.observable(e)}},{key:"resolveModel",value:function(e){return e&&o.Backbone&&o.Backbone.ModelRef&&e instanceof o.Backbone.ModelRef?e.model():e}}],(r=null)&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();return e.wrappedDestroy=r(18),e.collapseOptions=r(15),e.unwrapModels=r(17),e}.call(void 0)},function(e,t,r){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var f,r=f=r(0),_=r._,p=r.ko,u=function(e,t){t=e.__kb.internals&&~_.indexOf(e.__kb.internals,t)?"_".concat(t):t;if(!e.__kb.view_model.hasOwnProperty(t))return e.__kb.view_model[t]=null,t},c=function(e,t,r,n){var i;if((!e.__kb.excludes||!~_.indexOf(e.__kb.excludes,r))&&(!e.__kb.statics||!~_.indexOf(e.__kb.statics,r))&&(i=u(e,r)))return e[i]=e.__kb.view_model[i]=f.observable(t,r,n,e)},b=function(e,t){for(var r,n=e.__kb.statics,i=0,o=n.length;i<o;i++)r=n[i],(r=u(e,r))&&(t.has(r)?e[r]=e.__kb.view_model[r]=t.get(r):e.__kb.static_defaults&&r in e.__kb.static_defaults?e[r]=e.__kb.view_model[r]=e.__kb.static_defaults[r]:delete e.__kb.view_model[r])},v=["keys","internals","excludes","statics","static_defaults"];f.ViewModel=function(){var e=function(){function r(s){var u,c=this,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=this,t=r;if(e instanceof t)return u=Array.prototype.slice.call(_.isArguments(s)?s:arguments),f.ignore(function(){var t,e,r,n,i,o,a,l;for((s=u.shift())&&!f.isModel(s)&&f._throwUnexpected(c,"not a model"),_.isArray(u[0])&&(u[0]={keys:u[0]}),c.__kb||(c.__kb={}),c.__kb.view_model=1<u.length?u.pop():c,d={},n=0,a=u.length;n<a;n++)e=u[n],_.extend(d,e);for(d=f.utils.collapseOptions(d),i=0,l=v.length;i<l;i++)o=v[i],d.hasOwnProperty(o)&&(c.__kb[o]=d[o]);return f.Store.useOptionsOrCreate(d,s,c),c.__kb.path=d.path,f.Factory.useOptionsOrCreate(d,c,d.path),t=f.utils.set(c,"_model",p.observable()),c.model=p.computed({read:function(){return p.utils.unwrapObservable(t)},write:function(e){return f.ignore(function(){if(!f.wasReleased(c)&&r)return c.__kb.store.reuse(c,f.utils.resolveModel(e)),r.emitter(e),t(r.ee),!r.ee||c.createObservables(r.ee)})}}),r=f.utils.wrappedEventWatcher(c,new f.EventWatcher(s,c,{emitter:c._model,update:function(){return f.ignore(function(){return!(null!=r&&r.ee)||c.createObservables(null!=r?r.ee:void 0)})}})),f.utils.wrappedObject(c,s=r.ee),t(r.ee),c.__kb.create_options={store:f.utils.wrappedStore(c),factory:f.utils.wrappedFactory(c),path:c.__kb.path,event_watcher:f.utils.wrappedEventWatcher(c)},d.requires&&c.createObservables(s,d.requires),c.__kb.internals&&c.createObservables(s,c.__kb.internals),d.mappings&&c.createObservables(s,d.mappings),c.__kb.statics&&b(c,s),c.createObservables(s,c.__kb.keys),f.statistics&&f.statistics.register("ViewModel",c),c});throw new TypeError("Cannot call a class as a function")}var e,t,n;return e=r,(t=[{key:"destroy",value:function(){var t;return this.__kb_released=!0,this.__kb.view_model!==this&&function(){var e=[];for(t in this.__kb.vm_keys)e.push(this.__kb.view_model[t]=null);return e}.call(this),this.__kb.view_model=this.__kb.create_options=null,f.releaseKeys(this),f.utils.wrappedDestroy(this),!f.statistics||f.statistics.unregister("ViewModel",this)}},{key:"shareOptions",value:function(){return{store:f.utils.wrappedStore(this),factory:f.utils.wrappedFactory(this)}}},{key:"createObservables",value:function(n,e){var t,i,r,o,a,l,s;if(e)if(_.isArray(e))for(t=0,r=e.length;t<r;t++)i=e[t],c(this,n,i,this.__kb.create_options);else for(i in e)o=e[i],(s=u(this,i))&&(_.isString(o)||o.key||(o.key=s),this[s]=this.__kb.view_model[s]=f.observable(n,o,this.__kb.create_options,this));else if(!this.__kb.keys&&n){for(i in n.attributes)c(this,n,i,this.__kb.create_options);(l=null!=(a=f.settings.orm)&&"function"==typeof a.keys?a.keys(n):void 0)&&!function(){for(var e=[],t=0,r=l.length;t<r;t++)i=l[t],e.push(c(this,n,i,this.__kb.create_options));return e}.call(this)}}}])&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),r}();return e.extend=f.extend,e}.call(void 0),f.viewModel=function(e,t,r){return new f.ViewModel(arguments)}},function(e,t,r){"use strict";var i=r(0)._,o=function(e,t,r){return e[t]||(e[t]=[]),i.isArray(r)||(r=[r]),e[t]=e[t].length?i.union(e[t],r):r,e},a=function(e,t,r){return e[t]||(e[t]={}),i.extend(e[t],r)},l=function(e){for(var t,r={},n=0,i=e.length;n<i;n++)r[t=e[n]]={key:t};return r},s=function(e,t){var r,n;if(!t)return e;for(r in t)switch(n=t[r],r){case"internals":case"requires":case"excludes":case"statics":o(e,r,n);break;case"keys":i.isObject(n)&&!i.isArray(n)||i.isObject(e[r])&&!i.isArray(e[r])?(i.isObject(n)||(n=[n]),i.isArray(n)&&(n=l(n)),i.isArray(e[r])&&(e[r]=l(e[r])),a(e,r,n)):o(e,r,n);break;case"factories":i.isFunction(n)?e[r]=n:a(e,r,n);break;case"static_defaults":a(e,r,n);break;case"options":break;default:e[r]=n}return s(e,t.options)};e.exports=function(e){return s({},e)}},function(e,t,r){"use strict";var i=function(e,t){var r,n;for(r in t)n=t[r],e[r]=n;return e},o=function(){};e.exports=function(e,t){r=this,t=t,n=(e=e)&&e.hasOwnProperty("constructor")?e.constructor:function(){r.apply(this,arguments)},i(n,r),o.prototype=r.prototype,n.prototype=new o,e&&i(n.prototype,e),t&&i(n,t),(n.prototype.constructor=n).__super__=r.prototype;var r,n,e=n;return e.extend=this.extend,e}},function(e,t,r){"use strict";var i,o=r(0)._;e.exports=i=function(e){var t,r,n;if(e){if(e.__kb)return e.__kb.hasOwnProperty("object")?e.__kb.object:e;if(o.isArray(e))return o.map(e,i);if(o.isObject(e)&&e.constructor==={}.constructor){for(t in r={},e)n=e[t],r[t]=i(n);return r}}return e}},function(e,t,r){"use strict";var n;r(0)._;e.exports=n=function(e){var t,r;if(e.__kb&&(e.__kb.event_watcher&&e.__kb.event_watcher.releaseCallbacks(e),t=e.__kb,e.__kb=null,t.observable&&(t.observable.destroy=t.observable.release=null,n(t.observable),t.observable=null),t.factory=null,t.event_watcher_is_owned&&t.event_watcher.destroy(),t.event_watcher=null,t.store_is_owned&&t.store.destroy(),t.store=null,t.stores_references))for(;r=t.stores_references.pop();)r.store.__kb_released||r.store.release(e)}},function(e,t,r){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}o=r(0);var o,a=o._,l=o.Backbone,s=null;e.exports=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function")}var t,r,n;return t=e,n=[{key:"isAvailable",value:function(){return!!(s=null!=l?l.AssociatedModel:void 0)}},{key:"keys",value:function(e){return e instanceof s?a.map(e.relations,function(e){return e.key}):null}},{key:"relationType",value:function(e,t){return e instanceof s&&(e=a.find(e.relations,function(e){return e.key===t}))?"Many"===e.type?o.TYPE_COLLECTION:o.TYPE_MODEL:null}},{key:"useFunction",value:function(){return!1}}],(r=null)&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},function(e,t,r){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c,r=c=r(0),o=r._,a=r.Backbone,l=null;e.exports=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function")}var t,r,n;return t=e,n=[{key:"isAvailable",value:function(){return!!(l=null!=a?a.RelationalModel:void 0)}},{key:"relationType",value:function(e,t){return e instanceof l&&(e=o.find(e.getRelations(),function(e){return e.key===t}))?e.collectionType||o.isArray(e.keyContents)?c.TYPE_COLLECTION:c.TYPE_MODEL:null}},{key:"bind",value:function(r,n,t,i){var o,a,e,l,s,u;if(!(u=this.relationType(r,n)))return null;if(s=function(e){return c.statistics&&c.statistics.addModelEvent({name:"update (relational)",model:e,key:n,path:i}),t()},a=c.Backbone.Relation.prototype.sanitizeOptions?["update","add","remove"]:["change","add","remove"],u===c.TYPE_COLLECTION)for(e=0,l=a.length;e<l;e++)o=a[e],r.bind("".concat(o,":").concat(n),s);else r.bind("".concat(a[0],":").concat(n),s);return function(){var e,t;if(u===c.TYPE_COLLECTION)for(e=0,t=a.length;e<t;e++)o=a[e],r.unbind("".concat(o,":").concat(n),s);else r.unbind("".concat(a[0],":").concat(n),s)}}},{key:"useFunction",value:function(){return!1}}],(r=null)&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},function(e,t){e.exports=r},function(e,t){e.exports=n},function(e,t){e.exports=i},function(e,t,r){r(4),r(1),r(5),r(6),r(8),r(0),r(9),r(10),r(11),r(12),r(2),r(13),r(14),e.exports=r(7)}],l={},o.m=a,o.c=l,o.i=function(e){return e},o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=24);function o(e){if(l[e])return l[e].exports;var t=l[e]={i:e,l:!1,exports:{}};return a[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}var a,l});