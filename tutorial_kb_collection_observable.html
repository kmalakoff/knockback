<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutorial: kb.CollectionObservable</title>
    <link rel="stylesheet" href="vendor/css/normalize.css">
    <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap-responsive.min.css">
    <link rel="stylesheet" href="vendor/google-code-prettify/prettify.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/layout_components.css">
    <link rel="icon" href="favicon.ico">
    <script type="application/javascript" src="vendor/js/jquery-1.9.1.js"></script>
    <link rel="stylesheet" href="css/tutorial.css">
    <script type="application/javascript" src="vendor/globalize/globalize.js"></script>
    <script type="application/javascript" src="vendor/globalize/globalize.culture.en-GB.js"></script>
    <script type="application/javascript" src="vendor/globalize/globalize.culture.fr-FR.js"></script>
    <script type="application/javascript" src="vendor/js/knockback-full-stack-0.17.2.js"></script>
    <script type="application/javascript" src="vendor/bootstrap/js/bootstrap.min.js"></script>
    <script type="application/javascript" src="vendor/google-code-prettify/prettify.js"></script>
    <script type="application/javascript" src="js/stylecode.js"></script>
    <script type="application/javascript" src="js/interface.js"></script>
  </head>
  <body>
    <div class="page navbar">
      <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="navbar-inner">
          <div class="container"><a data-toggle="collapse" data-target=".nav-collapse" class="btn btn-navbar"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></a><a href="https://github.com/kmalakoff/knockback" class="brand kb">Knockback.js</a>
            <div class="nav-collapse">
              <ul class="nav">
                <li><a href="index.html">Home</a></li>
                <li><a href="doc/index.html">API</a></li>
                <li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Getting Started<b class="caret"></b></a>
                  <ul role="menu" class="dropdown-menu">
                    <li><a href="getting_started_introduction.html">Overview</a><a href="getting_started_dependent_library_basics.html">Dependent Library Basics</a><a href="getting_started_knockback_basics.html">Knockback Basics</a><a href="getting_started_views_view_models_models.html">Models, Views, and ViewModels</a><a href="getting_started_memory_lifecycle_management.html">Memory and Lifecycle Management</a><a href="getting_started_knockback_important_details.html">Knockback Important Details</a>
                    </li>
                  </ul>
                </li>
                <li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Components<b class="caret"></b></a>
                  <ul role="menu" class="dropdown-menu">
                    <li><a href="components_backbone_relational.html">Backbone Relational</a><a href="components_backbone_modelref.html">Backbone ModelRef</a><a href="components_knockback_inspector.html">Knockback Inspector</a><a href="components_knockback_navigators.html">Knockback Navigators</a>
                    </li>
                  </ul>
                </li>
                <li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Applications<b class="caret"></b></a>
                  <ul role="menu" class="dropdown-menu">
                    <li><a href="app_knockback_reference.html">Knockback Reference App</a><a href="app_todos.html">Todos App</a>
                    </li>
                  </ul>
                </li>
                <li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Tutorials<b class="caret"></b></a>
                  <ul role="menu" class="dropdown-menu">
                    <li><a href="tutorials_introduction.html">Introduction</a><a href="tutorial_kb_observable.html">kb.Observable</a><a href="tutorial_kb_view_model.html">kb.ViewModel</a><a href="tutorial_kb_collection_observable.html">kb.CollectionObservable</a><a href="tutorial_nested_models.html">Nested Models</a><a href="tutorial_relational_models.html">Relational Models</a><a href="tutorial_kb_localized_observable.html">kb.LocalizedObservable</a><a href="tutorial_locale_manager.html">Custom Locale Manager</a><a href="tutorial_inject.html">ViewModel Injection</a><a href="tutorial_knockback_inspector.html">Knockback Inspector (Advanced)</a>
                    </li>
                  </ul>
                </li>
                <li><a href="https://github.com/kmalakoff/knockback/blob/master/RELEASE_NOTES.md">Release Notes</a></li>
              </ul>
              <div id="script_language">
                <div class="separator">
                  <div class="selection codestyle">
                    <div class="option">
                      <input id="cs-cs" type="radio" name="codestyle" value="cs" class="auto"/>
                      <label for="cs-cs">CS</label>
                    </div>
                    <div class="option">
                      <input id="cs-js" type="radio" name="codestyle" value="js"/>
                      <label for="cs-js">JS</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="container">
      <header class="page">
      </header>
      <content class="page"><h1>Tutorial: kb.CollectionObservable</h1>
<p><a href="index.html">Knockback.js</a> provides an <a href="doc/classes/kb/CollectionObservable.html">kb.CollectionObservable</a> that watches Backbone.Collections when models are added, removed, and changed. In addition, kb.CollectionObservables can be used to sort models independently from the Backbone.Collection order, to bind HTML select elements, to render/edit <a href="tutorial_relational_models.html">model relationships</a>, and to filter collections.</p>
<h2>Sorting Models</h2>
<p>You can sort models using an <a href="doc/classes/kb/CollectionObservable.html#sortAttribute-instance">attribute name</a> or by providing a <a href="doc/classes/kb/CollectionObservable.html#sortedIndex-instance">sorted_index function</a>.</p>

        <div class="row-fluid">
          <div class="span8">
            <ul class="nav nav-tabs">
              <li class="active"><a href="#kbco_sorting_view" data-toggle="tab">View (HTML)</a></li>
              <li><a href="#kbco_sorting_view_model" data-toggle="tab">ViewModel (CS/JS)</a></li>
            </ul>
            <div class="tab-content">
              <div id="kbco_sorting_view" class="tab-pane active">
                <pre>&lt;div id='kbco_sorting' &gt;
  &lt;legend&gt;Sort Attribute
    &lt;select data-bind=&quot;options: sort_attributes, selectedOptions: sort_attribute&quot;&gt;&lt;/select&gt;
  &lt;/legend&gt;
  &lt;div data-bind=&quot;foreach: people&quot;&gt;
    &lt;div class='row-fluid'&gt;
      &lt;div class='span5'&gt;
        &lt;span&gt;First: &lt;/span&gt;
        &lt;input class='input-small' data-bind=&quot;value: first, valueUpdate: 'keyup'&quot;/&gt;
      &lt;/div&gt;
      &lt;div class='offset1 span5'&gt;
        &lt;span&gt;Last: &lt;/span&gt;
        &lt;input class='input-small' data-bind=&quot;value: last, valueUpdate: 'keyup'&quot;/&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
              </div>
              <div id="kbco_sorting_view_model" class="tab-pane">
                <pre data-for="cs">people = new Backbone.Collection([{first: 'Jeremy', last: 'Sanderson'}, {first: 'Steven', last: 'Ashkenas'}])
sort_attribute = ko.observable('first')

view_model =
  sort_attribute: sort_attribute
  sort_attributes: ko.observableArray(['first', 'last'])
  people: kb.collectionObservable(people, {sort_attribute: sort_attribute})

ko.applyBindings(view_model, $('#kbco_sorting')[0])</pre>
                <pre data-for="js">var people = new Backbone.Collection([{first: 'Jeremy', last: 'Sanderson'}, {first: 'Steven', last: 'Ashkenas'}]);
var sort_attribute = ko.observable('first');

var view_model = {
  sort_attribute: sort_attribute,
  sort_attributes: ko.observableArray(['first', 'last']),
  people: kb.collectionObservable(people, {sort_attribute: sort_attribute})
};

ko.applyBindings(view_model, $('#kbco_sorting')[0]);</pre>
              </div>
            </div>
          </div>
          <div class="span4">
            <h4>Live Result</h4>
            <div class="demos_result_box"><div id='kbco_sorting' >
  <legend>Sort Attribute
    <select data-bind="options: sort_attributes, selectedOptions: sort_attribute"></select>
  </legend>
  <div data-bind="foreach: people">
    <div class='row-fluid'>
      <div class='span5'>
        <span>First: </span>
        <input class='input-small' data-bind="value: first, valueUpdate: 'keyup'"/>
      </div>
      <div class='offset1 span5'>
        <span>Last: </span>
        <input class='input-small' data-bind="value: last, valueUpdate: 'keyup'"/>
      </div>
    </div>
  </div>
</div>
              <script type="application/javascript" src="tutorials/kb_collection_observable/kbco_sorting_view_model_bindings.js"></script>
            </div>
          </div>
        </div><h2>Filtering Models</h2>
<p>You can use kb.CollectionObservables to filter both ViewModels or Models (using the &#39;models_only&#39; option) using the filters constructor option. Filters can be individual ids (observable or simple) or arrays of ids, functions, or arrays of functions.</p>

        <div class="row-fluid">
          <div class="span8">
            <ul class="nav nav-tabs">
              <li class="active"><a href="#kbco_filtering_view" data-toggle="tab">View (HTML)</a></li>
              <li><a href="#kbco_filtering_view_model" data-toggle="tab">ViewModel (CS/JS)</a></li>
            </ul>
            <div class="tab-content">
              <div id="kbco_filtering_view" class="tab-pane active">
                <pre>&lt;div id='kbco_filtering' &gt;
  &lt;legend&gt;Filter Name
   &lt;select data-bind=&quot;options: available_names, selectedOptions: filtered_names&quot;&gt;&lt;/select&gt;
  &lt;/legend&gt;
  &lt;div data-bind=&quot;foreach: people&quot;&gt;
    &lt;div class='row-fluid'&gt;
      &lt;div class='span5'&gt;
        &lt;span&gt;First: &lt;/span&gt;
        &lt;input class='input-small' data-bind=&quot;value: first, valueUpdate: 'keyup'&quot;/&gt;
      &lt;/div&gt;
      &lt;div class='offset1 span5'&gt;
        &lt;span&gt;Last: &lt;/span&gt;
        &lt;input class='input-small' data-bind=&quot;value: last, valueUpdate: 'keyup'&quot;/&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
              </div>
              <div id="kbco_filtering_view_model" class="tab-pane">
                <pre data-for="cs">people = new Backbone.Collection([{first: 'Jeremy', last: 'Ashkenas'}, {first: 'Steven', last: 'Sanderson'}, {first: 'Kevin', last: 'Malakoff'}])
filtered_names = ko.observableArray(['Kevin'])

view_model =
  filtered_names: filtered_names
  available_names: ko.observableArray(people.map((model) -&gt; return model.get('first')))
  people: kb.collectionObservable(people, {filters: (model) -&gt; return model.get('first') is filtered_names()[0]})

ko.applyBindings(view_model, $('#kbco_filtering')[0])</pre>
                <pre data-for="js">var people = new Backbone.Collection([{first: 'Jeremy', last: 'Ashkenas'}, {first: 'Steven', last: 'Sanderson'}, {first: 'Kevin', last: 'Malakoff'}]);
var filtered_names = ko.observableArray(['Kevin']);

var view_model = {
  filtered_names: filtered_names,
  available_names: ko.observableArray(people.map(function(model) { return model.get('first'); })),
  people: kb.collectionObservable(people, {filters: function(model) { return model.get('first') === filtered_names()[0]; } })
};

ko.applyBindings(view_model, $('#kbco_filtering')[0]);</pre>
              </div>
            </div>
          </div>
          <div class="span4">
            <h4>Live Result</h4>
            <div class="demos_result_box"><div id='kbco_filtering' >
  <legend>Filter Name
   <select data-bind="options: available_names, selectedOptions: filtered_names"></select>
  </legend>
  <div data-bind="foreach: people">
    <div class='row-fluid'>
      <div class='span5'>
        <span>First: </span>
        <input class='input-small' data-bind="value: first, valueUpdate: 'keyup'"/>
      </div>
      <div class='offset1 span5'>
        <span>Last: </span>
        <input class='input-small' data-bind="value: last, valueUpdate: 'keyup'"/>
      </div>
    </div>
  </div>
</div>
              <script type="application/javascript" src="tutorials/kb_collection_observable/kbco_filtering_view_model_bindings.js"></script>
            </div>
          </div>
        </div><h2>HTML Select Statements</h2>
<p>You can use kb.CollectionObservables to bind HTML select statements using <a href="http://knockoutjs.com/">Knockout.js selectOptions</a>.</p>

        <div class="row-fluid">
          <div class="span8">
            <ul class="nav nav-tabs">
              <li class="active"><a href="#kbco_html_select_view" data-toggle="tab">View (HTML)</a></li>
              <li><a href="#kbco_html_select_view_model" data-toggle="tab">ViewModel (CS/JS)</a></li>
            </ul>
            <div class="tab-content">
              <div id="kbco_html_select_view" class="tab-pane active">
                <pre>&lt;div id='kbco_html_select'&gt;
  &lt;select multiple=&quot;multiple&quot; data-bind=&quot;options: people, optionsText: 'name', selectedOptions: selected_people&quot;&gt;&lt;/select&gt;
  &lt;div&gt;
    &lt;span&gt;Selected people: &lt;/span&gt;
    &lt;!-- ko foreach: selected_people --&gt;
    &lt;span data-bind=&quot;text: name&quot;&gt;&lt;/span&gt;
    &lt;!-- /ko --&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
              </div>
              <div id="kbco_html_select_view_model" class="tab-pane">
                <pre data-for="cs">people = new Backbone.Collection([{name: 'Bob'}, {name: 'Sarah'}, {name: 'George'}])
selected_people = new Backbone.Collection()

view_model =
  people: kb.collectionObservable(people)
  selected_people: kb.collectionObservable(selected_people)

ko.applyBindings(view_model, $('#kbco_html_select')[0])</pre>
                <pre data-for="js">var people = new Backbone.Collection([{name: 'Bob'}, {name: 'Sarah'}, {name: 'George'}]);
var selected_people = new Backbone.Collection();

var view_model = {
  people: kb.collectionObservable(people),
  selected_people: kb.collectionObservable(selected_people)
};

ko.applyBindings(view_model, $('#kbco_html_select')[0]);</pre>
              </div>
            </div>
          </div>
          <div class="span4">
            <h4>Live Result</h4>
            <div class="demos_result_box"><div id='kbco_html_select'>
  <select multiple="multiple" data-bind="options: people, optionsText: 'name', selectedOptions: selected_people"></select>
  <div>
    <span>Selected people: </span>
    <!-- ko foreach: selected_people -->
    <span data-bind="text: name"></span>
    <!-- /ko -->
  </div>
</div>
              <script type="application/javascript" src="tutorials/kb_collection_observable/kbco_html_select_view_model_bindings.js"></script>
            </div>
          </div>
        </div><p>One important constraint is that in order for <a href="http://knockoutjs.com/documentation/selectedOptions-binding.html">Knockout.js select bindings</a> to work, the same ViewModel instance needs to be included in each kb.CollectionObservable. You can use <a href="doc/classes/kb/CollectionObservable.html#shareOptions-instance">shareOptions</a> to share the kb.Store and hence ViewModels between kb.CollectionObservables.</p>
<p>Here is an adapted sample from <a href="http://kmalakoff.github.com/knockback-reference-app">Knockback Reference App</a>.</p>

        <div class="row-fluid">
          <div class="span8">
            <ul class="nav nav-tabs">
              <li class="active"><a href="#kbco_share_options_view" data-toggle="tab">View (HTML)</a></li>
              <li><a href="#kbco_share_options_view_model" data-toggle="tab">ViewModel (CS/JS)</a></li>
            </ul>
            <div class="tab-content">
              <div id="kbco_share_options_view" class="tab-pane active">
                <pre>&lt;div id='kbco_share_options'&gt;
  &lt;div data-bind=&quot;text: name&quot;&gt;&lt;/div&gt;
  &lt;select multiple=&quot;multiple&quot; data-bind=&quot;options: available_things, optionsText: 'name', selectedOptions: my_things&quot;&gt;&lt;/select&gt;

  &lt;p&gt;
    &lt;span&gt;My Things:&lt;/span&gt;
    &lt;!-- ko foreach: my_things --&gt;
    &lt;span data-bind=&quot;text: name&quot;&gt;&lt;/span&gt;
    &lt;!-- /ko --&gt;
  &lt;/p&gt;
&lt;/div&gt;</pre>
              </div>
              <div id="kbco_share_options_view_model" class="tab-pane">
                <pre data-for="cs">chair = new Backbone.Model({name: 'chair', my_things: new Backbone.Collection()})
things = new Backbone.Collection([{name: 'leg1'}, {name: 'leg2'}, {name: 'leg3'}])

available_things = kb.collectionObservable(things)
view_model =
  available_things: available_things
  name: kb.observable(chair, 'name')
  my_things: kb.collectionObservable(chair.get('my_things'), available_things.shareOptions())

ko.applyBindings(view_model, $('#kbco_share_options')[0])</pre>
                <pre data-for="js">var chair = new Backbone.Model({name: 'chair', my_things: new Backbone.Collection()});
var things = new Backbone.Collection([{name: 'leg1'}, {name: 'leg2'}, {name: 'leg3'}]);

var available_things = kb.collectionObservable(things);
var view_model = {
  available_things: available_things,
  name: kb.observable(chair, 'name'),
  my_things: kb.collectionObservable(chair.get('my_things'), available_things.shareOptions())
};

ko.applyBindings(view_model, $('#kbco_share_options')[0]);</pre>
              </div>
            </div>
          </div>
          <div class="span4">
            <h4>Live Result</h4>
            <div class="demos_result_box"><div id='kbco_share_options'>
  <div data-bind="text: name"></div>
  <select multiple="multiple" data-bind="options: available_things, optionsText: 'name', selectedOptions: my_things"></select>

  <p>
    <span>My Things:</span>
    <!-- ko foreach: my_things -->
    <span data-bind="text: name"></span>
    <!-- /ko -->
  </p>
</div>
              <script type="application/javascript" src="tutorials/kb_collection_observable/kbco_share_options_view_model_bindings.js"></script>
            </div>
          </div>
        </div>
      </content>
      <footer class="page">
      </footer>
    </div>
  </body>
</html>